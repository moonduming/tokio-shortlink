# 数据库配置（MySQL 连接串）
DATABASE_URL=mysql://用户名:密码@主机地址:端口/数据库名

# Redis 连接地址
REDIS_URL=redis://主机地址:端口

# Web 服务监听地址和端口
ADDR=0.0.0.0:3000

# JWT 密钥（可随机生成一段较长字符串）
JWT_SECRET="请替换为你的 JWT 密钥"

# 用户 token 过期时间（秒），如 1 天
USER_TOKEN_TTL=86400

# 短链最短/最长过期时间（秒）
SHORTLINK_MIN_TTL=3600       # 最短 1 小时
SHORTLINK_MAX_TTL=604800     # 最长 7 天

# Redis 最大缓存 TTL（秒）
REDIS_MAX_TTL=86400

# 单个用户允许同时存在的 token 数量上限（如 3 表示最多登录 3 台设备）
USER_TOKEN_LIMIT=3

# Redis 缓存最小剩余有效期（秒），小于该值不写缓存
REDIS_MIN_CACHE_TTL=180

# 点击量最大可统计天数
MAX_STATS_DAYS=30

# IP 限流参数
IP_RATE_LIMIT=60                  # 时间窗口内允许的最大请求次数
IP_RATE_LIMIT_WINDOW=60           # IP 限流窗口（秒），如 60 秒

# 登录失败限制
USER_LOGIN_FAIL_LIMIT=5           # 账号连续失败次数阈值
USER_LOGIN_FAIL_TTL=900           # 账号连续失败锁定时长（秒）

IP_USER_LOGIN_FAIL_LIMIT=3        # 单 IP + 账号连续失败次数阈值
IP_USER_LOGIN_FAIL_TTL=120        # 单 IP + 账号连续失败锁定时长（秒）

# 注册接口限流
IP_REGISTER_LIMIT=10              # 每个 IP 每日最多注册次数
IP_REGISTER_TTL=86400             # 注册计数窗口（秒），86400=1天

# 用户侧限流参数
USER_RATE_LIMIT=100               # 用户限流阈值
USER_RATE_LIMIT_WINDOW=60         # 用户限流时间窗口（秒）

# 全局 HTTP 请求超时时间（毫秒），默认 3000 毫秒（3 秒）
GLOBAL_TIMEOUT_MS=3000

# 后台 Redis 任务最大并发数
BG_REDIS_MAX_CONCURRENCY=4
# 后台 Redis 任务队列容量
BG_REDIS_QUEUE_CAP=10

# 日志设置
RUST_LOG=info,tower_http::trace=info,sqlx=info

########################################
#             MySQL 配置项             #
########################################
# 最大连接数
MYSQL_MAX_CONNECTIONS=5
# 等待连接池中空闲连接的超时时间（毫秒）
MYSQL_ACQUIRE_TIMEOUT_MS=600
# 单个查询语句的最大执行时间（毫秒）
MYSQL_QUERY_TIMEOUT_MS=800
# InnoDB 表中等待锁的最大时间（秒）
MYSQL_LOCK_WAIT_TIMEOUT_S=2
########################################
#             Redis 配置项             #
########################################
# Redis 连接池最大连接数
REDIS_POOL_SIZE=4
# 等待空闲连接的最大时间（毫秒）
REDIS_TIMEOUT_WAIT_MS=300
# 新建连接的最大时间（毫秒）
REDIS_TIMEOUT_CREATE_MS=500
# 取连接前健康检查的超时时间（毫秒）
REDIS_TIMEOUT_RECYCLE_MS=200
########################################
#             定时任务 配置项             #
########################################
# 过期短链删除任务的执行间隔（秒）
BG_EXPIRED_LINKS_SYNC_INTERVAL=1800
# 点击量同步任务的执行间隔（秒）
BG_CLICK_COUNTS_SYNC_INTERVAL=900
# 访问日志同步任务的执行间隔（秒）
BG_VISIT_LOGS_SYNC_INTERVAL=1200